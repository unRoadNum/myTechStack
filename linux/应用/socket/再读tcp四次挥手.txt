## tcp四次挥手

tcp三次握手以后，开始send/recv数据了。
这个时候双方都是独占对方的ip地址：端口号的。

但是，当双方数据交互完成后，是不是需要释放ip地址：端口号资源？
那这个释放的过程就是tcp四次挥手。
下面简单的描述一下这个释放的过程，然后再分析其中的设计原理。

假设是A和B现在在进行tcp通信。
1. A发送结束数据包给B，告诉B：我不发送数据了，要结束通信了。
	* FIN标记置为1，表示不发送数据给B了
	* 在该报文中带上自己的seq=x，以防止B收到该消息后乱序
2. B收到的A发送的结束消息以后，先发送数据包给B自己已经收到该消息
	* ACK标记置为1，ack字段带上A下一个数据包的起始序号：x+1
	* 在该报文中带上自己的seq=y
3. 等了一会儿，B也不发送数据了，它发送数据包给A，告诉A自己也不发送数据了，结束通信吧。
	* FIN标记置为1，表示不发送数据给A
	* 在该报文中带上自己的seq=z
4. A收到B的发送结束数据包以后，告诉B：好的，我知道你要结束了，从此以后不接收你的消息了。
	* ACK标记置为1，ack字段取z+1
	* 带上自己的seq=x+1
	

	

